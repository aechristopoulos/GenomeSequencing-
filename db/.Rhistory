install.packages("rmeta")
install.packages("Rtools")
library("rmeta")
> source("http://bioconductor.org/biocLite.R")
> biocLite()
source ("http://bioconductor.org/biocLite.R")
source("http://bioconductor.org/biocLite.R")
> biocLite()
source("http://bioconductor.org/biocLite.R")biocLite()
source("http://bioconductor.org/biocLite.R")
> biocLite()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.15")
BiocManager::install(c("GenomicFeatures", "AnnotationDbi"))
if (!requireNamespace("BiocManager", quietly=TRUE))
install.packages("BiocManager")
BiocManager::install("msa")
library(msa)
system.file("tex", "texshade.sty", package="msa")
mySequenceFile <- system.file("examples", "exampleAA.fasta", package="msa")
mySequences <- readAAStringSet(mySequenceFile)
mySequences
myFirstAlignment <- msa(mySequences)
## use default substitution matrix
msa(mySequences)
print(myFirstAlignment, show="complete")
system.file("tex", "texshade.sty", package="msa")
msaPrettyPrint(myFirstAlignment, output="pdf", showNames="none",
showLogo="none", askForOverwrite=FALSE, verbose=FALSE)
msaPrettyPrint(myFirstAlignment, y=c(164, 213), output="asis",
showNames="none", showLogo="none", askForOverwrite=FALSE)
msaPrettyPrint(myFirstAlignment, output="pdf", showNames="none",
showLogo="none", askForOverwrite=FALSE, verbose=FALSE)
View(myFirstAlignment)
View(mySequences)
View(myFirstAlignment)
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db")
library("ape")
library("phangorn")
library("seqinr")
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
mt <- modelTest(HA_H5_phyDat)
print(mt)
min(mt[4])
#GRT+G
dna_dist <- dist.ml(HA_H5_phyDat, model = "JC69")
HA_H5_UPGMA <- upgma(dna_dist)
HA_H5_NJ <- NJ(dna_dist)
plot(HA_H5_UPGMA, main = "UPGMA")
plot(HA_H5_NJ, main = "Neighbor Joining")
parsimony(HA_H5_UPGMA, data = HA_H5_phyDat)
parsimony(HA_H5_NJ, data = HA_H5_phyDat)
#UPGMA = 316, NJ = 295 <-
HA_H5_optim <- optim.parsimony(HA_H5_NJ, HA_H5_phyDat)
HA_H5_pratchet <- pratchet(HA_H5_phyDat)
plot(HA_H5_optim, main = "Optimum")
plot(HA_H5_pratchet, main = "pratchet")
fit <- pml(HA_H5_NJ, HA_H5_10)
fit <- pml(HA_H5_NJ, HA_H5_phyDat)
print(fit)
fitJC <- optim.pml(fit, model = "JC", rearrangement = "stochastic")
logLik(fitJC)
bs <- bootstrap.pml(fitJC, bs =100, optNni=TRUE, multicore=TRUE, control = pml.control(trace=0))
plotBS(midpoint(fitJC$tree), bs, p = 50, type="p")
write.tree(bs, file = "trees/HA_H5_10_tree.nwk")
tree <- read.tree(file = "trees/HA_H5_10_tree.nwk")
ggtree(tree)
