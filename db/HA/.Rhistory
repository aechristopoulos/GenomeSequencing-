install.packages("rmeta")
install.packages("Rtools")
library("rmeta")
> source("http://bioconductor.org/biocLite.R")
> biocLite()
source ("http://bioconductor.org/biocLite.R")
source("http://bioconductor.org/biocLite.R")
> biocLite()
source("http://bioconductor.org/biocLite.R")biocLite()
source("http://bioconductor.org/biocLite.R")
> biocLite()
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.15")
BiocManager::install(c("GenomicFeatures", "AnnotationDbi"))
if (!requireNamespace("BiocManager", quietly=TRUE))
install.packages("BiocManager")
BiocManager::install("msa")
library(msa)
system.file("tex", "texshade.sty", package="msa")
mySequenceFile <- system.file("examples", "exampleAA.fasta", package="msa")
mySequences <- readAAStringSet(mySequenceFile)
mySequences
myFirstAlignment <- msa(mySequences)
## use default substitution matrix
msa(mySequences)
print(myFirstAlignment, show="complete")
system.file("tex", "texshade.sty", package="msa")
msaPrettyPrint(myFirstAlignment, output="pdf", showNames="none",
showLogo="none", askForOverwrite=FALSE, verbose=FALSE)
msaPrettyPrint(myFirstAlignment, y=c(164, 213), output="asis",
showNames="none", showLogo="none", askForOverwrite=FALSE)
msaPrettyPrint(myFirstAlignment, output="pdf", showNames="none",
showLogo="none", askForOverwrite=FALSE, verbose=FALSE)
View(myFirstAlignment)
View(mySequences)
View(myFirstAlignment)
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db")
library(ape)
library(phangorn)
library(seqinr)
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db")
library(ape)
library(phangorn)
library(seqinr)
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db/HA")
library(ape)
library(phangorn)
library(seqinr)
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5 <- read.dna("/HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
library("ape")
library("phangorn")
library("seqinr")
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5 <- read.dna("db/HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
setwd("C:/Users/Lexie Christopoulos/Repos/GenomeSequencing-/db")
HA_H5 <- read.dna("HA/tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
library("ape")
library("phangorn")
library("seqinr")
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
mt <- modelTest(HA_H5_phyDat)
print(mt)
min(mt[4])
#GRT+G
dna_dist <- dist.ml(HA_H5_phyDat, model = "JC69")
HA_H5_UPGMA <- upgma(dna_dist)
HA_H5_NJ <- NJ(dna_dist)
plot(HA_H5_UPGMA, main = "UPGMA")
plot(HA_H5_NJ, main = "Neighbor Joining")
parsimony(HA_H5_UPGMA, data = HA_H5_phyDat)
parsimony(HA_H5_NJ, data = HA_H5_phyDat)
#UPGMA = 316, NJ = 295 <-
HA_H5_optim <- optim.parsimony(HA_H5_NJ, HA_H5_phyDat)
HA_H5_pratchet <- pratchet(HA_H5_phyDat)
plot(HA_H5_optim, main = "Optimum")
plot(HA_H5_pratchet, main = "pratchet")
fit <- pml(HA_H5_NJ, HA_H5_phyDat)
print(fit)
fitJC <- optim.pml(fit, model = "JC", rearrangement = "stochastic")
logLik(fitJC)
bs <- bootstrap.pml(fitJC, bs =100, optNni=TRUE, multicore=TRUE, control = pml.control(trace=0))
plotBS(midpoint(fitJC$tree), bs, p = 50, type="p")
write.tree(bs, file = "HA/trees/HA_H5_tree.nwk")
write.tree(bs, file = "trees/HA_H5_tree.nwk")
write.nexus(bs, filename = "trees/HA_H5_tree.nex")
write.tree(bs, file = "trees/HA_H5_tree.nwk")
nwk <- system.file("extdata", "trees/HA_H5_tree.nwk", package="ggtree")
tree <- read.tree(nwk)
tree <- read.tree(file = "trees/HA_H5_tree.nwk")
library("ape")
library("phangorn")
library("seqinr")
library("Biostrings")
library("ggplot2")
library("ggtree")
tree <- read.tree(file = "trees/HA_H5_tree.nwk")
ggtree(tree)
ggtree(tree, layout = "circular")
tree <- read.tree(file = "trees/HA_H5_tree.tree")
ggtree(tree, layout = "circular")
tree <- read.tree(file = "trees/HA_H1_tree.tree")
ggtree(tree, layout = "circular")
HA
nwk <- system.file("extdata", "HA/trees/HA_H5_tree.nwk", package="ggtree")
tree <- read.tree(nwk)
tree
nwk <- system.file("extdata", "HA/trees/HA_H5_tree.nwk", package="ggtree")
tree <- read.tree(nwk)
nwk <- system.file("HA/trees/HA_H5_tree.nwk", package="ggtree")
tree <- read.tree(nwk)
tree <- read.tree(nwk)
tree <- read.tree(file = "trees/HA_H5_tree.nwk")
ggtree(tree, layout = "circular")
ggtree(tree)
ggtree(tree) + geom_treescale()
ggtree(tree, msrd = "2023-02-10") + theme_tree2()+ ggtitle("Divergence Time")
ggtree(tree, mrsd = "2023-02-10") + theme_tree2()+ ggtitle("Divergence Time")
browseVignettes("ggtree")
tree <- read.tree(file = "trees/HA_H1_tree.tree")
ggtree(tree)
library("ape")
library("phangorn")
library("seqinr")
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
mt <- modelTest(HA_H5_phyDat)
print(mt)
min(mt[4])
#GRT+G
dna_dist <- dist.ml(HA_H5_phyDat, model = "JC69")
HA_H5_UPGMA <- upgma(dna_dist)
HA_H5_NJ <- NJ(dna_dist)
plot(HA_H5_UPGMA, main = "UPGMA")
plot(HA_H5_NJ, main = "Neighbor Joining")
parsimony(HA_H5_UPGMA, data = HA_H5_phyDat)
parsimony(HA_H5_NJ, data = HA_H5_phyDat)
#UPGMA = 316, NJ = 295 <-
HA_H5_optim <- optim.parsimony(HA_H5_NJ, HA_H5_phyDat)
HA_H5_pratchet <- pratchet(HA_H5_phyDat)
plot(HA_H5_optim, main = "Optimum")
plot(HA_H5_pratchet, main = "pratchet")
fit <- pml(HA_H5_NJ, HA_H5_phyDat)
print(fit)
fitJC <- optim.pml(fit, model = "JC", rearrangement = "stochastic")
logLik(fitJC)
bs <- bootstrap.pml(fitJC, bs =100, optNni=TRUE, multicore=TRUE, control = pml.control(trace=0))
plotBS(midpoint(fitJC$tree), bs, p = 50, type="p")
write.tree(bs, file = "trees/HA_H5_tree.nwk")
tree <- read.tree(file = "trees/HA_H1_tree.tree")
ggtree(tree)
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
HA_H5_10 <- subset(HA_H5_phyDat, 1:10)
HA_H5_10_phyDat <- phyDat(HA_H5_10, type = "DNA", levels = NULL)
View(HA_H5_10)
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
HA_H5_10 <- subset(HA_H5_phyDat, 1:10)
HA_H5_10_phyDat <- phyDat(HA_H5_10, type = "DNA", levels = NULL)
HA_H5 <- read.dna("tree_alignments/HA_H5_edited_NCR_alignment.fasta", format = "fasta")
HA_H5_phyDat <- phyDat(HA_H5, type = "DNA", levels =NULL)
HA_H5_10 <- subset(HA_H5_phyDat, 1:10)
mt <- modelTest(HA_H5_10)
print(mt)
min(mt[4])
#GRT+G
dna_dist <- dist.ml(HA_H5_10, model = "JC69")
HA_H5_UPGMA <- upgma(dna_dist)
HA_H5_NJ <- NJ(dna_dist)
plot(HA_H5_UPGMA, main = "UPGMA")
plot(HA_H5_NJ, main = "Neighbor Joining")
parsimony(HA_H5_UPGMA, data = HA_H5_phyDat)
parsimony(HA_H5_NJ, data = HA_H5_phyDat)
#UPGMA = 316, NJ = 295 <-
HA_H5_optim <- optim.parsimony(HA_H5_NJ, HA_H5_phyDat)
HA_H5_optim <- optim.parsimony(HA_H5_NJ, HA_H5_10)
HA_H5_pratchet <- pratchet(HA_H5_10)
plot(HA_H5_optim, main = "Optimum")
plot(HA_H5_pratchet, main = "pratchet")
fit <- pml(HA_H5_NJ, HA_H5_10)
print(fit)
fitJC <- optim.pml(fit, model = "JC", rearrangement = "stochastic")
logLik(fitJC)
bs <- bootstrap.pml(fitJC, bs =100, optNni=TRUE, multicore=TRUE, control = pml.control(trace=0))
plotBS(midpoint(fitJC$tree), bs, p = 50, type="p")
write.tree(bs, file = "trees/HA_H5_10_tree.nwk")
tree <- read.tree(file = "trees/HA_H5_10_tree.tree")
tree <- read.tree(file = "trees/HA_H5_10_tree.nwk")
ggtree(tree)
library(ape)
library(phangorn)
library(seqinr)
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H1 <- read.dna("HA/tree_alignments/HA_H1_edited_NCR_alignment.fasta", format = "fasta")
HA_H1 <- read.dna("tree_alignments/HA_H1_edited_NCR_alignment.fasta", format = "fasta")
HA_H1_phyDat <- phyDat(HA_H1, type = "DNA", levels =NULL)
HA_H1_10 <- subset(HA_H1_phyDat, 1:10)
library(ape)
library(phangorn)
library(seqinr)
library("Biostrings")
library("ggplot2")
library("ggtree")
HA_H1 <- read.dna("tree_alignments/HA_H1_edited_NCR_alignment.fasta", format = "fasta")
HA_H1_phyDat <- phyDat(HA_H1, type = "DNA", levels =NULL)
HA_H1_10 <- subset(HA_H1_phyDat, 1:10)
mt <- modelTest(HA_H1_10)
#print(mt)
min(mt[4])
#TPM1u+G(4)+I
dna_dist <- dist.ml(HA_H1_10, model = "JC69")
HA_H1_UPGMA <- upgma(dna_dist)
HA_H1_NJ <- NJ(dna_dist)
plot(HA_H1_UPGMA, main = "UPGMA")
plot(HA_H1_NJ, main = "Neighbor Joining")
parsimony(HA_H1_UPGMA, data = HA_H1_10)
parsimony(HA_H1_NJ, data = HA_H1_10)
#UPGMA = 831, NJ = 759 <-
HA_H1_optim <- optim.parsimony(HA_H1_NJ, HA_H1_10)
HA_H1_pratchet <- pratchet(HA_H1_phyDat)
plot(HA_H1_optim, main = "Optimum")
plot(HA_H1_pratchet, main = "pratchet")
fit <- pml(HA_H1_NJ, HA_H1_10)
print(fit)
fitJC <- optim.pml(fit, model = "JC", rearrangement = "stochastic")
logLik(fitJC)
bs <- bootstrap.pml(fitJC, bs =100, optNni=TRUE, multicore=TRUE, control = pml.control(trace=0))
plotBS(midpoint(fitJC$tree), bs, p = 50, type="p")
write.tree(bs, file = "HA/HA_H1_10_tree.nwk")
write.tree(bs, file = "trees/HA_H1_10_tree.nwk")
tree <- read.tree(file = "trees/HA_H1_10_tree.nwk")
ggtree(tree)
